<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>High Octane - Oil Today®</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwUxEirWwl3V9ZyL9HS3CP-MPndbXmtp8&libraries=places,geometry"></script>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 40px;
            background-color: #ffffff;
            min-height: 100vh;
            position: relative;
        }
    
        .nav {
            position: fixed;
            top: 40px;
            left: 40px;
        }
    
        .nav a {
            text-decoration: none;
            color: #000;
            font-size: 1.2rem;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        .chart-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        .nav a:hover {
            color: #FF4500;
        }
    
        .price-container {
            margin-top: 150px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
    
        .content-row {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
    
        .chart-section {
            flex: 1;
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .chart-section {
            position: relative;
        }

        .chart-title {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 1;  /* 그래프 위에 표시 */
        }

        .chart-container {
            margin-top: 60px;  /* 타이틀을 위한 공간 확보 */
            height: calc(100% - 60px);  /* 전체 높이에서 타이틀 공간 제외 */
        }
        .prediction-section {
            position: fixed;  /* 고정 위치 */
            top: 40px;       /* 상단에서의 거리 */
            left: 50%;       /* 왼쪽에서 50% */
            transform: translateX(-50%);  /* 중앙 정렬을 위해 자신의 너비의 절반만큼 왼쪽으로 이동 */
            z-index: 1000;   /* 다른 요소들 위에 표시 */
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: auto;     /* 내용에 맞게 너비 조정 */
            text-align: center;
        }
            
        .fuel-title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 40px;
        }
    
        .price-recommendation {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
    
        .recommendation-text {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 2rem;
            text-align: center;
            padding: 30px;
        }
    
        .confidence-indicator {
            font-size: 1rem;
            margin-top: 8px;
            color: #666;
            font-weight: normal;
        }
    
        .chart-container {
            height: 400px;
        }
    
        /* 현재 위치 가격 정보의 위치도 조정 */
        .current-location-price {
            position: fixed;
            top: 40px;
            right: 40px;
            z-index: 999;    /* prediction-section보다 낮은 z-index */
            width: 300px;
        }
    
        .location-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
    
        .current-price-card {
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .map-and-stations {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto 40px;
        }
    
        .recommended-stations {
            flex: 1;
            margin: 0;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .station-card {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
    
        .station-card:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
    
        .station-rank {
            font-size: 24px;
            font-weight: bold;
            margin-right: 20px;
            color: #FF4500;
        }
    
        .station-info {
            flex-grow: 1;
        }
    
        .station-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
    
        .station-details {
            font-size: 14px;
            color: #666;
        }
    
        .station-score {
            font-weight: bold;
            color: #FF4500;
        }
    
        .navi-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #FF4500;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }
    
        .navi-button:hover {
            background-color: #FF5722;
        }
    
        .navi-button i {
            font-size: 16px;
        }
    
        .map-container {
            flex: 1;
            margin: 0;
        }
    
        .map-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 20px;
        }
    
        #map {
            height: 500px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .price-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 한 줄에 4개씩 */
            gap: 30px;  /* 간격 증가 */
            margin: 40px 0;  /* 상하 여백 추가 */
            padding: 20px;  /* 내부 여백 추가 */
        }

        .price-card {
            background: #fff;
            border-radius: 15px;
            padding: 40px 30px;  /* 내부 여백 증가 */
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
    
        .price-card:hover {
            transform: translateY(-5px);
        }
    
        .increase {
            color: #FF4500;
        }
    
        .decrease {
            color: #4169E1;
        }
    
        @media (max-width: 1024px) {
            .current-location-price {
                position: fixed;
                top: 20px;
                right: 20px;
                width: 200px;
            }
    
            .current-price-card {
                padding: 15px;
            }
        }
    
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
    
            .nav {
                position: static;
                margin-bottom: 20px;
            }
    
            .content-row,
            .map-and-stations {
                flex-direction: column;
            }
    
            .chart-section,
            .prediction-section,
            .recommended-stations,
            .map-container {
                width: 100%;
            }
    
            .current-location-price {
                position: fixed;
                top: 10px;
                right: 10px;
                width: 150px;
                font-size: 0.9em;
            }
    
            .current-price-card {
                padding: 10px;
            }
    
            .location-title {
                font-size: 1rem;
            }
    
            .fuel-title {
                font-size: 2rem;
                margin-bottom: 20px;
            }
    
            .recommendation-text {
                font-size: 1.2rem;
                padding: 15px;
            }
    
            .chart-container {
                height: 250px;
            }
    
            .station-card {
                padding: 12px;
            }
    
            .station-name {
                font-size: 16px;
            }
    
            .station-details {
                font-size: 12px;
            }
    
            .navi-button {
                padding: 6px 12px;
                font-size: 12px;
            }
    
            .price-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
    
            .price-card {
                padding: 20px;
            }
    
            #map {
                height: 300px;
            }
        }
    
        @media (max-width: 480px) {
            .current-location-price {
                position: fixed;
                top: 10px;
                right: 10px;
                width: 120px;
            }
    
            .station-card {
                flex-direction: column;
                text-align: center;
            }
    
            .station-rank {
                margin-right: 0;
                margin-bottom: 10px;
            }
    
            .station-info {
                margin-bottom: 10px;
            }
    
            .navi-button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="../index.html">HOME</a>
    </nav>

    <div class="prediction-section">
        <div class="price-recommendation">
            <!-- JavaScript에서 동적으로 채워짐 -->
        </div>
    </div>

    <div class="price-container">
        <div class="fuel-title">High Octane</div>
        
        <!-- 지도와 추천 주유소 섹션 -->
        <div class="map-and-stations">
            <div class="recommended-stations">
                <h2>🏆 추천 주유소 TOP 3</h2>
                <div id="stationList">
                    <!-- 동적으로 채워질 내용 -->
                </div>
            </div>
            
            <div class="map-container">
                <div class="map-title">주변 주유소 찾기</div>
                <div id="map"></div>
            </div>
        </div>

        <!-- 그래프 섹션 -->
        <div class="chart-section">
            <h2 class="chart-title">최근 7일간 가격 변동</h2>
            <div class="chart-container">
                <canvas id="priceChart"></canvas>
            </div>
        </div>

        <!-- 가격 그리드 -->
        <div class="price-grid" id="priceGrid">
            <!-- 데이터는 JavaScript로 동적 생성됨 -->
        </div>
    </div>

    <div class="current-location-price">
        <div class="location-title">현재 위치 가격</div>
        <div class="current-price-card">
            <div class="current-region">위치 확인 중...</div>
            <div class="current-price">가격 확인 중...</div>
            <div class="current-change">변동 확인 중...</div>
        </div>
    </div>
</body>

    <script>
        // 전역 변수 선언
        let currentDirectionsRenderer = null;
        let currentInfoWindow = null;
    
        // 주유소 점수 계산 함수
        function calculateStationScore(station, userLocation) {
            if (!station.rating) {
                return -1;
            }
    
            const distance = google.maps.geometry.spherical.computeDistanceBetween(
                userLocation,
                station.geometry.location
            );
            
            let w1;
            if (distance <= 500) w1 = 1.0;
            else if (distance <= 1000) w1 = 0.8;
            else if (distance <= 1500) w1 = 0.6;
            else if (distance <= 2000) w1 = 0.4;
            else if (distance <= 2500) w1 = 0.2;
            else if (distance <= 3000) w1 = 0.1;
            else w1 = 0.0;
    
            let w2;
            const rating = station.rating;
            if (rating >= 4.5) w2 = 1.0;
            else if (rating >= 4.0) w2 = 0.8;
            else if (rating >= 3.5) w2 = 0.5;
            else if (rating >= 3.0) w2 = 0.3;
            else w2 = 0.1;
    
            return (w1 * 0.7) + (w2 * 0.3);
        }
    
        function calculateConfidence(prices) {
            const recentTrends = [];
            for (let i = prices.length - 3; i < prices.length - 1; i++) {
                recentTrends.push(Math.sign(prices[i + 1] - prices[i]));
            }
            
            const trendConsistency = new Set(recentTrends).size === 1;
            const volatility = Math.sqrt(
                prices.slice(-3)
                    .map(x => Math.pow(x - prices[prices.length-1], 2))
                    .reduce((a, b) => a + b, 0) / 3
            );
            
            let confidence = trendConsistency ? 80 : 60;
            confidence -= (volatility > 10) ? 20 : 0;
            
            return Math.min(Math.max(confidence, 0), 100);
        }
    
        function predictNextDayPrice(prices) {
            const ma = prices.slice(-3).reduce((a, b) => a + b) / 3;
            const trend = prices[prices.length - 1] - prices[prices.length - 2];
            return ma + trend;
        }
    
        async function getCurrentLocationName(lat, lng) {
            const geocoder = new google.maps.Geocoder();
            const latlng = { lat: parseFloat(lat), lng: parseFloat(lng) };
            
            try {
                const response = await new Promise((resolve, reject) => {
                    geocoder.geocode({ location: latlng }, (results, status) => {
                        if (status === "OK") {
                            resolve(results);
                        } else {
                            reject(status);
                        }
                    });
                });
    
                for (let component of response[0].address_components) {
                    if (component.types.includes('administrative_area_level_1')) {
                        let shortName = component.short_name
                            .replace('광역시', '')
                            .replace('특별시', '')
                            .replace('특별자치시', '')
                            .replace('특별자치도', '')
                            .replace('도', '');
                        return shortName;
                    }
                }
                return '알 수 없음';
            } catch (error) {
                console.error('Geocoding 실패:', error);
                return '알 수 없음';
            }
        }
    
        async function updateCurrentLocationPrice(priceData, lat, lng) {
            try {
                const locationName = await getCurrentLocationName(lat, lng);
                const regionData = priceData[locationName];
                
                const currentPriceCard = document.querySelector('.current-price-card');
                if (regionData) {
                    currentPriceCard.innerHTML = `
                        <div class="current-region">${locationName}</div>
                        <div class="current-price">${regionData.price.toFixed(1)}원</div>
                        <div class="current-change ${regionData.diff >= 0 ? 'increase' : 'decrease'}">
                            ${regionData.diff >= 0 ? '▲' : '▼'} ${Math.abs(regionData.diff).toFixed(1)}원
                        </div>
                    `;
                } else {
                    currentPriceCard.innerHTML = `
                        <div class="current-region">${locationName}</div>
                        <div class="current-price">가격 정보 없음</div>
                        <div class="current-change">-</div>
                    `;
                }
            } catch (error) {
                console.error('현재 위치 가격 업데이트 실패:', error);
            }
        }
        async function loadPriceData(position) {
        try {
            console.log('Fetching data...');
            const sidoResponse = await fetch('../api/data/oil_prices_sido.json');
            const sidoData = await sidoResponse.json();
            
            const historyResponse = await fetch('../api/data/oil_prices_7day.json');
            const historyData = await historyResponse.json();
            
            // 하이옥탄의 제품코드(B034)로 변경
            const dieselData = sidoData.filter(item => item.PRODCD === "B034");
            // "고급휘발유"로 변경
            const historicalPrices = historyData.historical_prices["고급휘발유"];
            
            const priceData = {};
            dieselData.forEach(item => {
                priceData[item.SIDONM] = {
                    price: parseFloat(item.PRICE),
                    diff: parseFloat(item.DIFF)
                };
            });

            if (position && position.coords) {
                await updateCurrentLocationPrice(priceData, position.coords.latitude, position.coords.longitude);
            }

            const mainRegions = ['전국 평균','서울', '경기', '인천','대전','대구','부산','울산','광주','제주'];
            const priceGrid = document.getElementById('priceGrid');
            priceGrid.innerHTML = '';

            const avgPrice = Object.values(priceData).reduce((sum, item) => sum + item.price, 0) / Object.keys(priceData).length;
            const avgDiff = Object.values(priceData).reduce((sum, item) => sum + item.diff, 0) / Object.keys(priceData).length;

            const predictedPrice = predictNextDayPrice(historicalPrices);
            const confidence = calculateConfidence(historicalPrices);

            // 예측 결과 표시
            const priceRecommendation = document.querySelector('.price-recommendation');
            priceRecommendation.innerHTML = `
                <div class="recommendation-text ${predictedPrice > historicalPrices[historicalPrices.length-1] ? 'increase' : 'decrease'}">
                    ${predictedPrice > historicalPrices[historicalPrices.length-1] ? 
                        '💡 오늘 주유해야해용~' : 
                        '💡 내일 넣는게 조타잉~'}
                    <div class="confidence-indicator">
                        신뢰도: ${confidence}%
                    </div>
                </div>
            `;

            // 차트 생성
            const ctx = document.getElementById('priceChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['7일전', '6일전', '5일전', '4일전', '3일전', '2일전', '오늘', '내일'],
                    datasets: [{
                        label: '실제 가격',
                        data: historicalPrices,
                        borderColor: '#FF4500',
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointBackgroundColor: '#FF4500'
                    },
                    {
                        label: '예측 가격',
                        data: [...Array(historicalPrices.length-1).fill(null), 
                               historicalPrices[historicalPrices.length-1], 
                               predictedPrice],
                        borderColor: '#4169E1',
                        borderDash: [5, 5],
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointBackgroundColor: '#4169E1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            // 지역별 가격 그리드 생성
            mainRegions.forEach(region => {
                const price = region === '전국 평균' ? avgPrice : priceData[region].price;
                const diff = region === '전국 평균' ? avgDiff : priceData[region].diff;
                
                const card = document.createElement('div');
                card.className = 'price-card';
                card.innerHTML = `
                    <div class="region">${region}</div>
                    <div class="price">${price.toFixed(1)}원</div>
                    <div class="change ${diff >= 0 ? 'increase' : 'decrease'}">
                        ${diff >= 0 ? '▲' : '▼'} ${Math.abs(diff).toFixed(1)}원
                    </div>
                `;
                priceGrid.appendChild(card);
            });

        } catch (error) {
            console.error('Error details:', error);
        }
    }

    function initMap(position) {
        const pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
        };

        const map = new google.maps.Map(document.getElementById("map"), {
            center: pos,
            zoom: 15,
            styles: [
                {
                    featureType: "poi.business",
                    stylers: [{ visibility: "off" }],
                }
            ]
        });

        // 현재 위치 마커
        new google.maps.Marker({
            position: pos,
            map: map,
            icon: {
                path: google.maps.SymbolPath.CIRCLE,
                scale: 8,
                fillColor: "#FF4500",
                fillOpacity: 1,
                strokeWeight: 2,
                strokeColor: "#FFFFFF",
            },
            title: "현재 위치"
        });

        // 주변 주유소 검색
        const service = new google.maps.places.PlacesService(map);
        service.nearbySearch({
            location: pos,
            radius: 3000,
            keyword: '주유소'
        }, (results, status) => {
            if (status === google.maps.places.PlacesServiceStatus.OK) {
                const scoredStations = results
                    .filter(station => station.rating)
                    .map(station => ({
                        station: station,
                        score: calculateStationScore(station, new google.maps.LatLng(pos.lat, pos.lng))
                    }))
                    .filter(item => item.score > 0);

                const topStations = scoredStations
                    .sort((a, b) => b.score - a.score)
                    .slice(0, 3);

                const stationList = document.getElementById('stationList');
                stationList.innerHTML = '';

                // 상위 3개 주유소 표시
                topStations.forEach((item, index) => {
                    const station = item.station;
                    const distance = google.maps.geometry.spherical.computeDistanceBetween(
                        new google.maps.LatLng(pos.lat, pos.lng),
                        station.geometry.location
                    );

                    const card = document.createElement('div');
                    card.className = 'station-card';
                    // 주유소 카드 HTML 부분 수정
                    card.innerHTML = `
                        <div class="station-info">
                            <div class="station-rank">${index + 1}</div>
                            <div class="station-content">
                                <div class="station-name">${station.name}</div>
                                <div class="station-details">
                                    <span class="station-score">거리: ${(distance/1000).toFixed(1)}km</span> | 
                                    ⭐ ${station.rating.toFixed(1)} 
                                    (${station.user_ratings_total}개의 평가)
                                </div>
                            </div>
                        </div>
                        <button class="navi-button">
                            <i class="fas fa-route"></i>
                            경로안내
                        </button>
                    `;

                    // 경로안내 버튼 클릭 이벤트
                    const naviButton = card.querySelector('.navi-button');
                    // 경로안내 버튼 클릭 이벤트
                    // 경로안내 버튼 클릭 이벤트
                    naviButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        
                        // 좌표를 소수점 6자리까지만 제한
                        const startLat = parseFloat(pos.lat).toFixed(6);
                        const startLng = parseFloat(pos.lng).toFixed(6);
                        const endLat = parseFloat(station.geometry.location.lat()).toFixed(6);
                        const endLng = parseFloat(station.geometry.location.lng()).toFixed(6);

                        // 네이버 모바일 지도 URL 사용
                        // 모바일 기기 체크 (맥북 제외)
                        // 모바일 기기 체크 (맥북 제외)
                        // 디바이스 체크 로직 수정
                        // 디바이스 체크 로직 수정 (M1 맥북 포함)
                        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                        const isApple = /Macintosh|MacIntel|MacPPC|Mac68K/i.test(navigator.userAgent);
                        const isM1 = /arm/i.test(navigator.userAgent);

                        if (isMobile && !isApple && !isM1) {
                            // 순수 모바일 기기용 URL
                            naverUrl = `nmap://route/car?slat=${startLat}&slng=${startLng}&sname=현재위치&dlat=${endLat}&dlng=${endLng}&dname=${encodeURIComponent(station.name)}&appname=com.example.myapp`;
                        } else {
                            // PC 및 맥북용 URL (새로운 네이버 지도 형식)
                            const startCoord = `${startLng},${startLat}`;  // 경도,위도 순서
                            const endCoord = `${station.geometry.location.lng()},${station.geometry.location.lat()}`;
                            
                            naverUrl = `https://map.naver.com/p/directions/${startCoord},현재위치,,,/${endCoord},${encodeURIComponent(station.name)},,/-/car?c=${startCoord},13`;
                        }
                        
                        window.open(naverUrl, '_blank');
                    });

                    // 카드 클릭 이벤트
                    card.addEventListener('click', () => {
                        const stationLocation = station.geometry.location;
                        const bounds = new google.maps.LatLngBounds();
                        bounds.extend(pos);
                        bounds.extend(stationLocation);
                        map.fitBounds(bounds);
                    });

                    stationList.appendChild(card);
                });

                // 모든 주유소 마커 표시
                results.forEach(place => {
                    const marker = new google.maps.Marker({
                        map: map,
                        position: place.geometry.location,
                        icon: {
                            url: "https://maps.google.com/mapfiles/ms/icons/gas.png",
                            scaledSize: new google.maps.Size(32, 32)
                        }
                    });

                    marker.addListener("click", () => {
                        if (currentInfoWindow) {
                            currentInfoWindow.close();
                        }

                        service.getDetails(
                            {
                                placeId: place.place_id,
                                fields: ["name", "formatted_address", "rating", "user_ratings_total", "opening_hours", "formatted_phone_number"]
                            },
                            (placeDetails, status) => {
                                if (status === google.maps.places.PlacesServiceStatus.OK) {
                                    const infoWindow = new google.maps.InfoWindow();
                                    currentInfoWindow = infoWindow;

                                    infoWindow.setContent(`
                                        <div class="info-window">
                                            <h3>${placeDetails.name}</h3>
                                            <p>🏢 ${placeDetails.formatted_address}</p>
                                            ${placeDetails.formatted_phone_number ? 
                                                `<p>📞 ${placeDetails.formatted_phone_number}</p>` : ''}
                                            ${placeDetails.rating ? 
                                                `<p>⭐️ ${placeDetails.rating} (${placeDetails.user_ratings_total}개의 평가)</p>` : ''}
                                            ${placeDetails.opening_hours?.isOpen() ? 
                                                '<p style="color: green;">✅ 영업중</p>' : 
                                                '<p style="color: red;">❌ 영업종료</p>'}
                                        </div>
                                    `);
                                    infoWindow.open(map, marker);
                                }
                            }
                        );
                    });
                });
            }
        });

        loadPriceData(position);
    }

    function handleLocationError(error) {
        console.log("위치 정보를 가져올 수 없습니다:", error);
        initMap({ coords: { latitude: 36.3504119, longitude: 127.3845475 } });
    }

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(initMap, handleLocationError);
    } else {
        console.log("위치 정보를 사용할 수 없습니다.");
    }
</script>

